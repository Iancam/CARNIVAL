sum(Dorothea_Density_All<-1 & Dorothea_Density_All>1)
sum(Dorothea_Density_All<-2 & Dorothea_Density_All>2)
sum(Dorothea_Density_All<-2 | Dorothea_Density_All>2)
sum(Dorothea_Density_All<-1.5 | Dorothea_Density_All>1.5)
sum(Dorothea_Density_All<-3 | Dorothea_Density_All>3)
Dorothea_Density_All<-3
Dorothea_Density_All <- unlist(Dorothea_Density_List)
Dorothea_Density_All < (-3)
sum(Dorothea_Density_All < (-3) | Dorothea_Density_All>3)
sum(Dorothea_Density_All < (-1.5) | Dorothea_Density_All>1.5)
polygon(d_all,col="blue")
d_all <- density(Dorothea_Density_All)
plot(d_all,type="n")
polygon(d_all,col="blue")
pdf("Dorothea_All_Histogram.pdf")
hist(Dorothea_Density_All)
dev.off()
View(Dorothea)
Dorothea_CutOff_Abs_1p5 <- Dorothea[,2:ncol(Dorothea)]
View(Dorothea_CutOff_Abs_1p5)
Dorothea_CutOff_Abs_1p5 <- Dorothea[,2:ncol(Dorothea)]
Dorothea_CutOff_Abs_1p5[Dorothea_CutOff_Abs_1p5>=1.5] <- 1
Dorothea_CutOff_Abs_1p5[Dorothea_CutOff_Abs_1p5<=(-1.5)] <- 1
Dorothea_CutOff_Abs_1p5[Dorothea_CutOff_Abs_1p5<(1.5) & Dorothea_CutOff_Abs_1p5>(-1.5)] <- NaN
View(Dorothea_CutOff_Abs_1p5)
Dorothea_CutOff_Abs_1p5<(1.5)
Dorothea_CutOff_Abs_1p5 <- Dorothea[,2:ncol(Dorothea)]
Dorothea_CutOff_Abs_1p5[Dorothea_CutOff_Abs_1p5>=1.5] <- 1
Dorothea_CutOff_Abs_1p5[Dorothea_CutOff_Abs_1p5<=(-1.5)] <- 1
View(Dorothea_CutOff_Abs_1p5)
Dorothea_CutOff_Abs_1p5 <- Dorothea[,2:ncol(Dorothea)]
Dorothea_CutOff_Abs_1p5[Dorothea_CutOff_Abs_1p5>=1.5] <- 1
Dorothea_CutOff_Abs_1p5[Dorothea_CutOff_Abs_1p5<=(-1.5)] <- -1
View(Dorothea_CutOff_Abs_1p5)
Dorothea_CutOff_Abs_1p5<(1.5)
View(Dorothea_CutOff_Abs_1p5)
Dorothea_CutOff_Abs_1p5<1.5
View(Dorothea_CutOff_Abs_1p5)
Dorothea_CutOff_Abs_1p5[Dorothea_CutOff_Abs_1p5<1.5 & Dorothea_CutOff_Abs_1p5>(-1.5)] <- NaN
Dorothea_CutOff_Abs_1p5 <- Dorothea[,2:ncol(Dorothea)]
Dorothea_CutOff_Abs_1p5[Dorothea_CutOff_Abs_1p5<1.5 & Dorothea_CutOff_Abs_1p5>(-1.5)] <- NaN
Dorothea_CutOff_Abs_1p5[Dorothea_CutOff_Abs_1p5>=1.5] <- 1
Dorothea_CutOff_Abs_1p5[Dorothea_CutOff_Abs_1p5<=(-1.5)] <- -1
View(Dorothea_CutOff_Abs_1p5)
Dorothea_CutOff_Abs_1p5[is.nan(Dorothea_CutOff_Abs_1p5)] <- 0
Dorothea_CutOff_Abs_1p5 <- Dorothea[,2:ncol(Dorothea)]
Dorothea_CutOff_Abs_1p5[Dorothea_CutOff_Abs_1p5<1.5 & Dorothea_CutOff_Abs_1p5>(-1.5)] <- NaN
Dorothea_CutOff_Abs_1p5[Dorothea_CutOff_Abs_1p5>=1.5] <- 1
Dorothea_CutOff_Abs_1p5[Dorothea_CutOff_Abs_1p5<=(-1.5)] <- -1
is.nan(Dorothea_CutOff_Abs_1p5)
Dorothea_CutOff_Abs_1p5[Dorothea_CutOff_Abs_1p5>=1.5] <- 1
Dorothea_CutOff_Abs_1p5[Dorothea_CutOff_Abs_1p5<=(-1.5)] <- -1
Dorothea_CutOff_Abs_1p5[is.nan(as.matrix(Dorothea_CutOff_Abs_1p5))] <- 0
View(Dorothea_CutOff_Abs_1p5)
ColNamesNew <- colnames(Dorothea_CutOff_Abs_1p5)
ColNamesNew <- substring(colnames(Dorothea_CutOff_Abs_1p5),4)
colnames(Dorothea_CutOff_Abs_1p5) <- ColNamesNew
View(Dorothea_CutOff_Abs_1p5)
write.table(x = Dorothea_CutOff_Abs_1p5,file = "Dorothea_CutOff_Abs_1p5_All",quote = F,sep = "\t",col.names = T,row.names = F)
View(Dorothea)
Dorothea_CutOff_Abs_1p5_betaxolol <- Dorothea_CutOff_Abs_1p5[1,]
View(Dorothea_CutOff_Abs_1p5_betaxolol)
Dorothea_CutOff_Abs_1p5_betaxolol <- Dorothea_CutOff_Abs_1p5_betaxolol[Dorothea_CutOff_Abs_1p5_betaxolol!=0]
Dorothea_CutOff_Abs_1p5_betaxolol <- Dorothea_CutOff_Abs_1p5[1,]
View(Dorothea_CutOff_Abs_1p5_betaxolol)
Dorothea_CutOff_Abs_1p5_betaxolol <- matrix(Dorothea_CutOff_Abs_1p5_betaxolol[Dorothea_CutOff_Abs_1p5_betaxolol!=0],nrow = 1,ncol = length(Dorothea_CutOff_Abs_1p5_betaxolol[Dorothea_CutOff_Abs_1p5_betaxolol!=0]))
View(Dorothea_CutOff_Abs_1p5_betaxolol)
ColNamesSingle <- ColNamesNew(Dorothea_CutOff_Abs_1p5_betaxolol!=0)
ColNamesNew <- substring(colnames(Dorothea_CutOff_Abs_1p5),4)
ColNamesSingle <- ColNamesNew(Dorothea_CutOff_Abs_1p5_betaxolol!=0)
ColNamesSingle <- ColNamesNew[Dorothea_CutOff_Abs_1p5_betaxolol!=0]
Dorothea_CutOff_Abs_1p5_betaxolol!=0
Dorothea_CutOff_Abs_1p5_betaxolol <- Dorothea_CutOff_Abs_1p5[1,]
ColNamesSingle <- ColNamesNew[Dorothea_CutOff_Abs_1p5_betaxolol!=0]
colnames(Dorothea_CutOff_Abs_1p5) <- ColNamesNew
Dorothea_CutOff_Abs_1p5 <- Dorothea[,2:ncol(Dorothea)]
Dorothea_CutOff_Abs_1p5[Dorothea_CutOff_Abs_1p5<1.5 & Dorothea_CutOff_Abs_1p5>(-1.5)] <- NaN
Dorothea_CutOff_Abs_1p5[Dorothea_CutOff_Abs_1p5>=1.5] <- 1
Dorothea_CutOff_Abs_1p5[Dorothea_CutOff_Abs_1p5<=(-1.5)] <- -1
Dorothea_CutOff_Abs_1p5[is.nan(as.matrix(Dorothea_CutOff_Abs_1p5))] <- 0
ColNamesNew <- substring(colnames(Dorothea_CutOff_Abs_1p5),4)
colnames(Dorothea_CutOff_Abs_1p5) <- ColNamesNew
write.table(x = Dorothea_CutOff_Abs_1p5,file = "Dorothea_CutOff_Abs_1p5_All",quote = F,sep = "\t",col.names = T,row.names = F)
Dorothea_CutOff_Abs_1p5_betaxolol <- Dorothea_CutOff_Abs_1p5[1,]
ColNamesSingle <- ColNamesNew[Dorothea_CutOff_Abs_1p5_betaxolol!=0]
colnames(Dorothea_CutOff_Abs_1p5_betaxolol) <- ColNamesSingle
View(Dorothea_CutOff_Abs_1p5_betaxolol)
sum(Dorothea_Density_All < (-1.5) | Dorothea_Density_All>1.5) # n=1990 (from n=6708)
Dorothea_CutOff_Abs_1p5 <- Dorothea[,2:ncol(Dorothea)]
Dorothea_CutOff_Abs_1p5[Dorothea_CutOff_Abs_1p5<1.5 & Dorothea_CutOff_Abs_1p5>(-1.5)] <- NaN
Dorothea_CutOff_Abs_1p5[Dorothea_CutOff_Abs_1p5>=1.5] <- 1
Dorothea_CutOff_Abs_1p5[Dorothea_CutOff_Abs_1p5<=(-1.5)] <- -1
Dorothea_CutOff_Abs_1p5[is.nan(as.matrix(Dorothea_CutOff_Abs_1p5))] <- 0
ColNamesNew <- substring(colnames(Dorothea_CutOff_Abs_1p5),4)
colnames(Dorothea_CutOff_Abs_1p5) <- ColNamesNew
write.table(x = Dorothea_CutOff_Abs_1p5,file = "Dorothea_CutOff_Abs_1p5_All",quote = F,sep = "\t",col.names = T,row.names = F)
Dorothea_CutOff_Abs_1p5_betaxolol <- Dorothea_CutOff_Abs_1p5[1,]
ColNamesSingle <- ColNamesNew[Dorothea_CutOff_Abs_1p5_betaxolol!=0]
Dorothea_CutOff_Abs_1p5_betaxolol <- matrix(Dorothea_CutOff_Abs_1p5_betaxolol[Dorothea_CutOff_Abs_1p5_betaxolol!=0],nrow = 1,ncol = length(Dorothea_CutOff_Abs_1p5_betaxolol[Dorothea_CutOff_Abs_1p5_betaxolol!=0]))
colnames(Dorothea_CutOff_Abs_1p5_betaxolol) <- ColNamesSingle
View(Dorothea_CutOff_Abs_1p5_betaxolol)
write.table(x = Dorothea_CutOff_Abs_1p5,file = "Dorothea_CutOff_Abs_1p5_All",quote = F,sep = "\t",col.names = T,row.names = F)
Dorothea_CutOff_Abs_1p5 <- Dorothea[,2:ncol(Dorothea)]
Dorothea_CutOff_Abs_1p5[Dorothea_CutOff_Abs_1p5<1.5 & Dorothea_CutOff_Abs_1p5>(-1.5)] <- NaN
Dorothea_CutOff_Abs_1p5[Dorothea_CutOff_Abs_1p5>=1.5] <- 1
Dorothea_CutOff_Abs_1p5[Dorothea_CutOff_Abs_1p5<=(-1.5)] <- -1
Dorothea_CutOff_Abs_1p5[is.nan(as.matrix(Dorothea_CutOff_Abs_1p5))] <- 0
ColNamesNew <- substring(colnames(Dorothea_CutOff_Abs_1p5),4)
colnames(Dorothea_CutOff_Abs_1p5) <- ColNamesNew
write.table(x = Dorothea_CutOff_Abs_1p5,file = "Dorothea_CutOff_Abs_1p5_All",quote = F,sep = "\t",col.names = T,row.names = F)
Dorothea_CutOff_Abs_1p5_betaxolol <- Dorothea_CutOff_Abs_1p5[1,]
ColNamesSingle <- ColNamesNew[Dorothea_CutOff_Abs_1p5_betaxolol!=0]
Dorothea_CutOff_Abs_1p5_betaxolol <- matrix(Dorothea_CutOff_Abs_1p5_betaxolol[Dorothea_CutOff_Abs_1p5_betaxolol!=0],nrow = 1,ncol = length(Dorothea_CutOff_Abs_1p5_betaxolol[Dorothea_CutOff_Abs_1p5_betaxolol!=0]))
colnames(Dorothea_CutOff_Abs_1p5_betaxolol) <- ColNamesSingle
write.table(x = Dorothea_CutOff_Abs_1p5,file = "Dorothea_CutOff_Abs_1p5_betaxolol",quote = F,sep = "\t",col.names = T,row.names = F)
Dorothea_CutOff_Abs_1p5 <- Dorothea[,2:ncol(Dorothea)]
Dorothea_CutOff_Abs_1p5[Dorothea_CutOff_Abs_1p5<1.5 & Dorothea_CutOff_Abs_1p5>(-1.5)] <- NaN
Dorothea_CutOff_Abs_1p5[Dorothea_CutOff_Abs_1p5>=1.5] <- 1
Dorothea_CutOff_Abs_1p5[Dorothea_CutOff_Abs_1p5<=(-1.5)] <- -1
Dorothea_CutOff_Abs_1p5[is.nan(as.matrix(Dorothea_CutOff_Abs_1p5))] <- 0
ColNamesNew <- substring(colnames(Dorothea_CutOff_Abs_1p5),4)
colnames(Dorothea_CutOff_Abs_1p5) <- ColNamesNew
write.table(x = Dorothea_CutOff_Abs_1p5,file = "Dorothea_CutOff_Abs_1p5_All",quote = F,sep = "\t",col.names = T,row.names = F)
Dorothea_CutOff_Abs_1p5_betaxolol <- Dorothea_CutOff_Abs_1p5[1,]
ColNamesSingle <- ColNamesNew[Dorothea_CutOff_Abs_1p5_betaxolol!=0]
Dorothea_CutOff_Abs_1p5_betaxolol <- matrix(Dorothea_CutOff_Abs_1p5_betaxolol[Dorothea_CutOff_Abs_1p5_betaxolol!=0],nrow = 1,ncol = length(Dorothea_CutOff_Abs_1p5_betaxolol[Dorothea_CutOff_Abs_1p5_betaxolol!=0]))
colnames(Dorothea_CutOff_Abs_1p5_betaxolol) <- ColNamesSingle
write.table(x = Dorothea_CutOff_Abs_1p5_betaxolol,file = "Dorothea_CutOff_Abs_1p5_betaxolol",quote = F,sep = "\t",col.names = T,row.names = F)
setwd("~/Desktop/CARNIVAL_Validation/E-MTAB-2091/annotation/") # set working directory (relative)
Stimuli <- read.table("Stimuli.csv",header = T,sep = ",",stringsAsFactors = F)
View(Stimuli)
setwd("~/Desktop/CARNIVAL_Validation/E-MTAB-2091/data/") # set working directory (relative)
Dorothea <- read.table("E-MTAB-2091_DoRothEA.csv",header=T,sep=",",stringsAsFactors = F)
rm(list=ls())
rm(list=ls());cat("\014")
setwd("~/Desktop/CARNIVAL_Validation/E-MTAB-2091/data/") # set working directory (relative)
Dorothea <- read.table("E-MTAB-2091_DoRothEA.csv",header=T,sep=",",stringsAsFactors = F)
setwd("~/Desktop/CARNIVAL_Validation/E-MTAB-2091/annotation/") # set working directory (relative)
View(Dorothea)
Conditions <- Dorothea[,1]
Stimuli <- read.table("Stimuli.csv",header = T,sep = ",",stringsAsFactors = F)
View(Stimuli)
View(Stimuli)
All_Targets <- Stimuli$Gene
All_Targets <- sort(All_Targets)
All_Targets <- Stimuli$Gene[nchar(Stimuli$Gene)>0]
All_Targets <- sort(All_Targets)
All_Targets_Matrix <- matrix(data = 0,nrow = nrow(Stimuli),ncol = length(All_Targets))
View(All_Targets_Matrix)
rownames(All_Targets_Matrix) <- Stimuli
colnames(All_Targets_Matrix) <- All_Targets
Stimuli
rownames(All_Targets_Matrix) <- Conditions
rm(list=ls());cat("\014")
setwd("~/Desktop/CARNIVAL_Validation/E-MTAB-2091/data/") # set working directory (relative)
Dorothea <- read.table("E-MTAB-2091_DoRothEA.csv",header=T,sep=",",stringsAsFactors = F)
Conditions <- Dorothea[,1]
setwd("~/Desktop/CARNIVAL_Validation/E-MTAB-2091/annotation/") # set working directory (relative)
Stimuli <- read.table("Stimuli.csv",header = T,sep = ",",stringsAsFactors = F)
All_Targets <- Stimuli$Gene[nchar(Stimuli$Gene)>0]
All_Targets <- sort(All_Targets)
All_Targets_Matrix <- matrix(data = 0,nrow = nrow(Stimuli),ncol = length(All_Targets))
rownames(All_Targets_Matrix) <- Conditions
Conditions
rownames(All_Targets_Matrix)
View(All_Targets_Matrix)
View(Stimuli)
counter=1
Stimuli[counter,2]
Stimuli[counter,2]==Conditions
IdxCond <- which(Stimuli[counter,2]==Conditions)
View(Stimuli)
IdxTarget <- which(Stimuli[counter,3]==All_Targets)
IdxTargets
IdxTarget
Stimuli[counter,3]
All_Targets
All_Targets <- Stimuli$Gene[nchar(Stimuli$Gene)>0]
All_Targets <- sort(unique(All_Targets))
All_Targets_Matrix <- matrix(data = 0,nrow = nrow(Stimuli),ncol = length(All_Targets))
colnames(All_Targets_Matrix) <- All_Targets
counter
IdxCond <- which(Stimuli[counter,2]==Conditions)
IdxTarget <- which(Stimuli[counter,3]==All_Targets)
IdxCond
IdxTarget
View(Stimuli)
All_Targets_Matrix[IdxCond,IdxTarget] <- Stimuli[counter,4]
View(All_Targets_Matrix)
rm(list=ls());cat("\014")
setwd("~/Desktop/CARNIVAL_Validation/E-MTAB-2091/data/") # set working directory (relative)
Dorothea <- read.table("E-MTAB-2091_DoRothEA.csv",header=T,sep=",",stringsAsFactors = F)
Conditions <- Dorothea[,1]
setwd("~/Desktop/CARNIVAL_Validation/E-MTAB-2091/annotation/") # set working directory (relative)
Stimuli <- read.table("Stimuli.csv",header = T,sep = ",",stringsAsFactors = F)
All_Targets <- Stimuli$Gene[nchar(Stimuli$Gene)>0]
All_Targets <- sort(unique(All_Targets))
All_Targets_Matrix <- matrix(data = 0,nrow = nrow(Stimuli),ncol = length(All_Targets))
colnames(All_Targets_Matrix) <- All_Targets
for (counter in 1:nrow(Stimuli)) {
IdxCond <- which(Stimuli[counter,2]==Conditions)
IdxTarget <- which(Stimuli[counter,3]==All_Targets)
All_Targets_Matrix[IdxCond,IdxTarget] <- Stimuli[counter,4]
}
View(All_Targets_Matrix)
write.table(x = All_Targets_Matrix,file = "DrugTarget_Input_All",quote = F,sep = "\t",col.names = T,row.names = F)
All_Targets_betaxolol <- All_Targets_Matrix[1,]
All_Targets_betaxolol <- All_Targets_betaxolol[All_Targets_betaxolol!=0]
Idx_NonZero <- which(All_Targets_betaxolol!=0])
Idx_NonZero <- which(All_Targets_betaxolol!=0)
All_Targets_betaxolol <- All_Targets_Matrix[1,]
Idx_NonZero <- which(All_Targets_betaxolol!=0)
All_Targets_betaxolol <- matrix(All_Targets_betaxolol[Idx_NonZero],1,length(Idx_NonZero))
colnames(All_Targets_betaxolol) <- All_Targets[Idx_NonZero]
View(All_Targets_betaxolol)
write.table(x = All_Targets_betaxolol,file = "All_Targets_betaxolol.tsv",quote = F,sep = "\t",col.names = T,row.names = F)
write.table(x = All_Targets_betaxolol,file = "DrugTarget_Input_betaxolol.tsv",quote = F,sep = "\t",col.names = T,row.names = F)
rm(list=ls());cat("\014")
setwd("~/Desktop/CARNIVAL_Validation/E-MTAB-2091/data/") # set working directory (relative)
Dorothea <- read.table("E-MTAB-2091_DoRothEA.csv",header=T,sep=",",stringsAsFactors = F)
Conditions <- Dorothea[,1]
Progeny <- read.table("E-MTAB-2091_PROGENy.csv",header=T,sep=",",stringsAsFactors = F)
View(Progeny)
rm(list=ls());cat("\014")
setwd("~/Desktop/CARNIVAL_Validation/E-MTAB-2091/data/") # set working directory (relative)
Dorothea <- read.table("E-MTAB-2091_DoRothEA.csv",header=T,sep=",",stringsAsFactors = F)
Conditions <- Dorothea[,1]
Progeny <- read.table("E-MTAB-2091_PROGENy.csv",header=T,sep=",",stringsAsFactors = F)
par(mfrow=c(8,7))
colname <- colnames(Progeny[2:length(Progeny)])
pdf("Progeny_Density_Plot.pdf")
Progeny_Density_List <- list()
for (counter in 1:(ncol(Progeny)-1)) {
d <- density(as.numeric(Progeny[,counter+1]))
plot(d, type="n",main=colname[counter])
polygon(d, col="red",border="gray")
# hist(as.numeric(Dorothea[1,2:nrow(Progeny)]))
Progeny_Density_List[[counter]] <- as.numeric(Progeny[,counter+1])
}
dev.off()
par(mfrow=c(1,1))
Progeny_Density_All <- unlist(Progeny_Density_List)
pdf("Progeny_All_Histogram.pdf")
dev.off()
Progeny_Density_All <- unlist(Progeny_Density_List)
pdf("Progeny_All_Histogram.pdf")
hist(Progeny_Density_All)
dev.off()
d_all <- density(Progeny_Density_All)
plot(d_all,type="n")
polygon(d_all,col="blue")
sum(Progeny_Density_All < (-1.5) | Progeny_Density_All>1.5) # n=1990 (from n=6708)
sum(Progeny_Density_All < (-50) | Progeny_Density_All>50) # n=717 (from n=728)
sum(Progeny_Density_All < (-50) | Progeny_Density_All>50) # n=493 (from n=728)
Progeny_CutOff_Abs_50 <- Progeny[,2:ncol(Progeny)]
View(Progeny_CutOff_Abs_50)
View(Progeny)
Progeny_CutOff_Abs_50[Progeny_CutOff_Abs_50<50 & Progeny_CutOff_Abs_1p5>(-50)] <- NaN
Progeny_CutOff_Abs_50[Progeny_CutOff_Abs_50<50 & Progeny_CutOff_Abs_50>(-50)] <- NaN
View(Progeny_CutOff_Abs_50)
Progeny_CutOff_Abs_50[Progeny_CutOff_Abs_50>=50] <- 1
Progeny_CutOff_Abs_50[Progeny_CutOff_Abs_50<=(-50)] <- -1
Progeny_CutOff_Abs_50[is.nan(as.matrix(Progeny_CutOff_Abs_50))] <- 0
ColNamesNew <- substring(colnames(Progeny_CutOff_Abs_50),4)
ColNamesNew <- substring(colnames(Progeny_CutOff_Abs_50),5)
colnames(Progeny_CutOff_Abs_50) <- ColNamesNew
write.table(x = Progeny_CutOff_Abs_50,file = "Progeny_CutOff_Abs_50_All",quote = F,sep = "\t",col.names = T,row.names = F)
View(Progeny_CutOff_Abs_50)
setwd("~/Desktop/CARNIVAL_Validation/E-MTAB-2091/annotation/") # set working directory (relative)
Stimuli <- read.table("Stimuli.csv",header = T,sep = ",",stringsAsFactors = F)
All_Targets <- Stimuli$Gene[nchar(Stimuli$Gene)>0]
All_Targets <- sort(unique(All_Targets))
All_Targets_Matrix <- matrix(data = 0,nrow = nrow(Stimuli),ncol = length(All_Targets))
colnames(All_Targets_Matrix) <- All_Targets
for (counter in 1:nrow(Stimuli)) {
IdxCond <- which(Stimuli[counter,2]==Conditions)
IdxTarget <- which(Stimuli[counter,3]==All_Targets)
All_Targets_Matrix[IdxCond,IdxTarget] <- Stimuli[counter,4]
}
write.table(x = All_Targets_Matrix,file = "DrugTarget_Input_All",quote = F,sep = "\t",col.names = T,row.names = F)
All_Targets_betaxolol <- All_Targets_Matrix[1,]
Idx_NonZero <- which(All_Targets_betaxolol!=0)
All_Targets_betaxolol <- matrix(All_Targets_betaxolol[Idx_NonZero],1,length(Idx_NonZero))
colnames(All_Targets_betaxolol) <- All_Targets[Idx_NonZero]
write.table(x = All_Targets_betaxolol,file = "DrugTarget_Input_betaxolol.tsv",quote = F,sep = "\t",col.names = T,row.names = F)
ProgenyProtein <- read.table("PROGENy_Protein.csv",header = T,sep = ",",stringsAsFactors = F)
View(ProgenyProtein)
Idx_NonZero
All_Targets_betaxolol
View(Progeny_CutOff_Abs_50)
View(ProgenyProtein)
length(unique(ProgenyProtein[,2]))
counter=1
ProgenyProtein_List[[counter]]$PROpw <- unique(ProgenyProtein[,2])[counter]
ProgenyProtein_List <- list()
ProgenyProtein_List[[counter]]$PROpw <- unique(ProgenyProtein[,2])[counter]
ProgenyProtein_List[[counter]][1] <- unique(ProgenyProtein[,2])[counter]
counter
ProgenyProtein_List[[counter]]
unique(ProgenyProtein[,2])[counter]
ProgenyProtein_List[[counter]]
ProgenyProtein_List
ProgenyProtein_List[counter] <- unique(ProgenyProtein[,2])[counter]
ProgenyProtein_List[counter]
ProgenyProtein_List[counter] <- list(unique(ProgenyProtein[,2])[counter])
ProgenyProtein_List[counter]
ProgenyProtein_List
ProgenyProtein_List[counter]$pw <- list(unique(ProgenyProtein[,2])[counter])
ProgenyProtein_List[counter] <- list(unique(ProgenyProtein[,2])[counter])
ProgenyProtein_List[counter] <- list(unique(ProgenyProtein[,2])[counter],'a')
ProgenyProtein_List <- NULL
ProgenyProtein_List[[counter]] <- list(unique(ProgenyProtein[,2])[counter])
ProgenyProtein_List[[counter]][1] <- list(unique(ProgenyProtein[,2])[counter])
Idx_pw_proteins <- which(unique(ProgenyProtein[,2])[counter]==ProgenyProtein[,2])
View(ProgenyProtein)
ProgenyProtein_List[[counter]][2] <- ProgenyProtein[Idx_pw_proteins,3]
ProgenyProtein <- read.table("PROGENy_Protein.csv",header = T,sep = ",",stringsAsFactors = F)
ProgenyProtein_List <- NULL
for (counter in 1:length(unique(ProgenyProtein[,2]))) {
ProgenyProtein_List[[counter]][1] <- list(unique(ProgenyProtein[,2])[counter])
Idx_pw_proteins <- which(unique(ProgenyProtein[,2])[counter]==ProgenyProtein[,2])
ProgenyProtein_List[[counter]][2] <- ProgenyProtein[Idx_pw_proteins,3]
}
ProgenyProtein_List <- list(unique(ProgenyProtein[,2])
for (counter in 1:length(unique(ProgenyProtein[,2]))) {
ProgenyProtein_List[[counter]][1] <- list(unique(ProgenyProtein[,2])[counter])
Idx_pw_proteins <- which(unique(ProgenyProtein[,2])[counter]==ProgenyProtein[,2])
ProgenyProtein_List[[counter]][2] <- ProgenyProtein[Idx_pw_proteins,3]
}
ProgenyProtein_List <- list(unique(ProgenyProtein[,2]))
ProgenyProtein_List <- vector(mode="list",length=(unique(ProgenyProtein[,2])))
(unique(ProgenyProtein[,2]))
ProgenyProtein_List <- vector(mode="list",length=length((unique(ProgenyProtein[,2]))))
for (counter in 1:length(unique(ProgenyProtein[,2]))) {
ProgenyProtein_List[[counter]][1] <- list(unique(ProgenyProtein[,2])[counter])
Idx_pw_proteins <- which(unique(ProgenyProtein[,2])[counter]==ProgenyProtein[,2])
ProgenyProtein_List[[counter]][2] <- ProgenyProtein[Idx_pw_proteins,3]
}
ProgenyProtein_List <- vector(mode="list",length=length((unique(ProgenyProtein[,2]))))
for (counter in 1:length(unique(ProgenyProtein[,2]))) {
ProgenyProtein_List[[counter]][1] <- unique(ProgenyProtein[,2])[counter]
Idx_pw_proteins <- which(unique(ProgenyProtein[,2])[counter]==ProgenyProtein[,2])
ProgenyProtein_List[[counter]][2] <- ProgenyProtein[Idx_pw_proteins,3]
}
ProgenyProtein_List <- vector(mode="list",length=length((unique(ProgenyProtein[,2]))))
ProgenyProtein_List[[1]]
ProgenyProtein_List[[2]]
ProgenyProtein_List[[1]][1] <- a
ProgenyProtein_List[[1]][1] <- 'a'
ProgenyProtein_List[[1]][2] <- 'b'
ProgenyProtein_List[[1]]
ProgenyProtein_List <- vector(mode="list",length=length((unique(ProgenyProtein[,2]))))
for (counter in 1:length(unique(ProgenyProtein[,2]))) {
ProgenyProtein_List[[counter]][[1]] <- unique(ProgenyProtein[,2])[counter]
Idx_pw_proteins <- which(unique(ProgenyProtein[,2])[counter]==ProgenyProtein[,2])
ProgenyProtein_List[[counter]][[2]] <- ProgenyProtein[Idx_pw_proteins,3]
}
counter
for (counter in 1:length(unique(ProgenyProtein[,2]))) {
ProgenyProtein_List[[counter]][1] <- unique(ProgenyProtein[,2])[counter]
Idx_pw_proteins <- which(unique(ProgenyProtein[,2])[counter]==ProgenyProtein[,2])
ProgenyProtein_List[[counter]][2] <- ProgenyProtein[Idx_pw_proteins,3]
}
ProgenyProtein_List <- vector(mode="list",length=length((unique(ProgenyProtein[,2]))))
for (counter in 1:length(unique(ProgenyProtein[,2]))) {
ProgenyProtein_List[[counter]]$pw <- unique(ProgenyProtein[,2])[counter]
Idx_pw_proteins <- which(unique(ProgenyProtein[,2])[counter]==ProgenyProtein[,2])
ProgenyProtein_List[[counter]]$prot <- ProgenyProtein[Idx_pw_proteins,3]
}
Progeny_CutOff_Abs_50
View(Progeny)
Progeny_CutOff_Abs_50_Betaxolol <- Progeny_CutOff_Abs_50[1,]
View(Progeny_CutOff_Abs_50_Betaxolol)
ncol(Progeny_CutOff_Abs_50_Betaxolol)
rm(list=ls());cat("\014")
setwd("~/Desktop/CARNIVAL_Validation/E-MTAB-2091/data/") # set working directory (relative)
Dorothea <- read.table("E-MTAB-2091_DoRothEA.csv",header=T,sep=",",stringsAsFactors = F)
Conditions <- Dorothea[,1]
Progeny <- read.table("E-MTAB-2091_PROGENy.csv",header=T,sep=",",stringsAsFactors = F)
par(mfrow=c(8,7))
colname <- colnames(Progeny[2:length(Progeny)])
pdf("Progeny_Density_Plot.pdf")
Progeny_Density_List <- list()
for (counter in 1:(ncol(Progeny)-1)) {
d <- density(as.numeric(Progeny[,counter+1]))
plot(d, type="n",main=colname[counter])
polygon(d, col="red",border="gray")
# hist(as.numeric(Dorothea[1,2:nrow(Progeny)]))
Progeny_Density_List[[counter]] <- as.numeric(Progeny[,counter+1])
}
dev.off()
par(mfrow=c(1,1))
Progeny_Density_All <- unlist(Progeny_Density_List)
pdf("Progeny_All_Histogram.pdf")
hist(Progeny_Density_All)
dev.off()
d_all <- density(Progeny_Density_All)
plot(d_all,type="n")
polygon(d_all,col="blue")
sum(Progeny_Density_All < (-50) | Progeny_Density_All>50) # n=493 (from n=728)
Progeny_CutOff_Abs_50 <- Progeny[,2:ncol(Progeny)]
Progeny_CutOff_Abs_50[Progeny_CutOff_Abs_50<50 & Progeny_CutOff_Abs_50>(-50)] <- NaN
Progeny_CutOff_Abs_50[Progeny_CutOff_Abs_50>=50] <- 1
Progeny_CutOff_Abs_50[Progeny_CutOff_Abs_50<=(-50)] <- -1
Progeny_CutOff_Abs_50[is.nan(as.matrix(Progeny_CutOff_Abs_50))] <- 0
View(Progeny_CutOff_Abs_50)
write.table(x = Progeny_CutOff_Abs_50,file = "Progeny_CutOff_Abs_50_All",quote = F,sep = "\t",col.names = T,row.names = F)
setwd("~/Desktop/CARNIVAL_Validation/E-MTAB-2091/annotation/") # set working directory (relative)
Stimuli <- read.table("Stimuli.csv",header = T,sep = ",",stringsAsFactors = F)
All_Targets <- Stimuli$Gene[nchar(Stimuli$Gene)>0]
All_Targets <- sort(unique(All_Targets))
All_Targets_Matrix <- matrix(data = 0,nrow = nrow(Stimuli),ncol = length(All_Targets))
colnames(All_Targets_Matrix) <- All_Targets
for (counter in 1:nrow(Stimuli)) {
IdxCond <- which(Stimuli[counter,2]==Conditions)
IdxTarget <- which(Stimuli[counter,3]==All_Targets)
All_Targets_Matrix[IdxCond,IdxTarget] <- Stimuli[counter,4]
}
write.table(x = All_Targets_Matrix,file = "DrugTarget_Input_All",quote = F,sep = "\t",col.names = T,row.names = F)
All_Targets_betaxolol <- All_Targets_Matrix[1,]
Idx_NonZero <- which(All_Targets_betaxolol!=0)
All_Targets_betaxolol <- matrix(All_Targets_betaxolol[Idx_NonZero],1,length(Idx_NonZero))
colnames(All_Targets_betaxolol) <- All_Targets[Idx_NonZero]
write.table(x = All_Targets_betaxolol,file = "DrugTarget_Input_betaxolol.tsv",quote = F,sep = "\t",col.names = T,row.names = F)
ProgenyProtein <- read.table("PROGENy_Protein.csv",header = T,sep = ",",stringsAsFactors = F)
View(ProgenyProtein)
View(ProgenyProtein)
ProgenyProtein <- read.table("PROGENy_Protein.csv",header = T,sep = ",",stringsAsFactors = F)
ProgenyProtein <- ProgenyProtein[order(ProgenyProtein[,2],ProgenyProtein[,3])]
ProgenyProtein <- ProgenyProtein[order(ProgenyProtein[,2],ProgenyProtein[,3]),]
View(ProgenyProtein)
ProgenyProtein_List <- vector(mode="list",length=length((unique(ProgenyProtein[,2]))))
for (counter in 1:length(unique(ProgenyProtein[,2]))) {
ProgenyProtein_List[[counter]]$pw <- unique(ProgenyProtein[,2])[counter]
Idx_pw_proteins <- which(unique(ProgenyProtein[,2])[counter]==ProgenyProtein[,2])
ProgenyProtein_List[[counter]]$prot <- ProgenyProtein[Idx_pw_proteins,3]
}
Progeny_CutOff_Abs_50_Betaxolol <- Progeny_CutOff_Abs_50[1,]
Progeny_Input_ToAdd <- NULL
colnames(Progeny_CutOff_Abs_50_Betaxolol)
ProgenyProtein[,2]
unique(ProgenyProtein[,2])
View(Progeny)
View(Progeny_CutOff_Abs_50_Betaxolol)
View(ProgenyProtein)
Progeny_CutOff_Abs_50_Betaxolol)[counter]
colnames(Progeny_CutOff_Abs_50_Betaxolol)[counter]
counter
unique(ProgenyProtein[,2])
Idx_ProgenyList <- which(colnames(Progeny_CutOff_Abs_50_Betaxolol)[counter]==unique(ProgenyProtein[,2]))
Idx+ProgenyProtein_List
Idx_ProgenyProtein_List
Idx_ProgenyList
ProgenyProtein_List[[Idx_ProgenyList]]
Matrix_ToAdd <- matrix(NA,2,length(ProgenyProtein_List[[Idx_ProgenyList]]))
View(Matrix_ToAdd)
length(ProgenyProtein_List[[Idx_ProgenyList]])
ProgenyProtein_List[[Idx_ProgenyList]]
Matrix_ToAdd <- matrix(NA,2,length(ProgenyProtein_List[[Idx_ProgenyList]]$prot))
Matrix_ToAdd[1,] <- ProgenyProtein_List[[Idx_ProgenyList]]
Matrix_ToAdd[1,] <- ProgenyProtein_List[[Idx_ProgenyList]]$prot
View(Progeny_CutOff_Abs_50_Betaxolol)
Progeny_Input_ToAdd <- NULL
for (counter in 1:ncol(Progeny_CutOff_Abs_50_Betaxolol)) {
if (Progeny_CutOff_Abs_50_Betaxolol[counter]!=0) {
Idx_ProgenyList <- which(colnames(Progeny_CutOff_Abs_50_Betaxolol)[counter]==unique(ProgenyProtein[,2]))
Matrix_ToAdd <- matrix(NA,2,length(ProgenyProtein_List[[Idx_ProgenyList]]$prot))
Matrix_ToAdd[1,] <- ProgenyProtein_List[[Idx_ProgenyList]]$prot
Matrix_ToAdd[2,] <- Progeny_CutOff_Abs_50_Betaxolol[counter]
Progeny_Input_ToAdd <- cbind(Progeny_Input_ToAdd,Matrix_ToAdd)
}
}
counter
Idx_ProgenyList
colnames(Progeny_CutOff_Abs_50_Betaxolol)[counter]
unique(ProgenyProtein[,2])
View(ProgenyProtein)
View(ProgenyProtein)
ProgenyProtein[,2] <- gsub("-",".",ProgenyProtein[,2],fixed=T)
View(ProgenyProtein)
ProgenyProtein <- read.table("PROGENy_Protein.csv",header = T,sep = ",",stringsAsFactors = F)
ProgenyProtein <- ProgenyProtein[order(ProgenyProtein[,2],ProgenyProtein[,3]),]
ProgenyProtein[,2] <- gsub("-",".",ProgenyProtein[,2],fixed=T)
ProgenyProtein_List <- vector(mode="list",length=length((unique(ProgenyProtein[,2]))))
for (counter in 1:length(unique(ProgenyProtein[,2]))) {
ProgenyProtein_List[[counter]]$pw <- unique(ProgenyProtein[,2])[counter]
Idx_pw_proteins <- which(unique(ProgenyProtein[,2])[counter]==ProgenyProtein[,2])
ProgenyProtein_List[[counter]]$prot <- ProgenyProtein[Idx_pw_proteins,3]
}
Progeny_CutOff_Abs_50_Betaxolol <- Progeny_CutOff_Abs_50[1,]
Progeny_Input_ToAdd <- NULL
for (counter in 1:ncol(Progeny_CutOff_Abs_50_Betaxolol)) {
if (Progeny_CutOff_Abs_50_Betaxolol[counter]!=0) {
Idx_ProgenyList <- which(colnames(Progeny_CutOff_Abs_50_Betaxolol)[counter]==unique(ProgenyProtein[,2]))
Matrix_ToAdd <- matrix(NA,2,length(ProgenyProtein_List[[Idx_ProgenyList]]$prot))
Matrix_ToAdd[1,] <- ProgenyProtein_List[[Idx_ProgenyList]]$prot
Matrix_ToAdd[2,] <- Progeny_CutOff_Abs_50_Betaxolol[counter]
Progeny_Input_ToAdd <- cbind(Progeny_Input_ToAdd,Matrix_ToAdd)
}
}
View(Progeny_Input_ToAdd)
View(Progeny_CutOff_Abs_50_Betaxolol)
cbind(All_Targets_betaxolol,Progeny_Input_ToAdd)
All_Targets_betaxolol
Progeny_Input_ToAdd
Progeny_Input <- matrix(Progeny_Input_ToAdd,1,ncol(Progeny_Input_ToAdd))
View(Progeny_Input)
Progeny_Input <- matrix(Progeny_Input_ToAdd[2,],1,ncol(Progeny_Input_ToAdd))
View(Progeny_Input)
colnames(Progeny_Input) <- Progeny_Input_ToAdd[1,]
View(Progeny_Input)
write.table(x = cbind(All_Targets_betaxolol,Progeny_Input),file = "DrugTarget_Input_betaxolol_plusPROGENy.tsv",quote = F,sep = "\t",col.names = T,row.names = F)
